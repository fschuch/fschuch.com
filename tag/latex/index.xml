<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>LaTeX | F. Schuch</title><link>https://www.fschuch.com/tag/latex/</link><atom:link href="https://www.fschuch.com/tag/latex/index.xml" rel="self" type="application/rss+xml"/><description>LaTeX</description><generator>Wowchemy (https://wowchemy.com)</generator><language>pt-br</language><copyright>© 2020-2025 Felipe N. Schuch</copyright><lastBuildDate>Wed, 14 Oct 2020 00:00:00 +0000</lastBuildDate><image><url>https://www.fschuch.com/media/icon_hu25d0b20bf2bf90ac27c6cbd6ce22358d_22074_512x512_fill_lanczos_center_2.png</url><title>LaTeX</title><link>https://www.fschuch.com/tag/latex/</link></image><item><title>Gráficos com qualidade de publicação em Python com Matplotlib</title><link>https://www.fschuch.com/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/</link><pubDate>Wed, 14 Oct 2020 00:00:00 +0000</pubDate><guid>https://www.fschuch.com/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/</guid><description>&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Lista de Conteúdos&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#introdução">Introdução&lt;/a>&lt;/li>
&lt;li>&lt;a href="#metodologia">Metodologia&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#localização">Localização&lt;/a>&lt;/li>
&lt;li>&lt;a href="#estilo">Estilo&lt;/a>&lt;/li>
&lt;li>&lt;a href="#dimensões">Dimensões&lt;/a>&lt;/li>
&lt;li>&lt;a href="#formato">Formato&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#conclusão">Conclusão&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="introdução">Introdução&lt;/h2>
&lt;p>A síntese e análises de dados e resultados na forma gráfica é um tópico de interesse para profissionais das mais diversas áreas, seja na produção de conteúdo técnico/científico, educacional, ou para divulgação em meios digitais. Uma boa figura vai atrair a atenção do seu público alvo.&lt;/p>
&lt;p>Existem quatro tópicos que, na minha opinião, influenciam diretamente no resultado final dos gráficos que serão produzidos, especialmente quando falamos em qualidade de publicação. São eles:&lt;/p>
&lt;ol>
&lt;li>&lt;strong>&lt;a href="#localiza%c3%a7%c3%a3o">Localização&lt;/a>:&lt;/strong> A formatação numérica deve estar de acordo com o idioma para o qual se está produzindo, seja na formatação de datas, moeda, ou mesmo o separador decimal;&lt;/li>
&lt;li>&lt;strong>&lt;a href="#estilo">Estilo&lt;/a>:&lt;/strong> Aqui se definem diversos aspectos visuais, como o esquema de cores do gráfico, eixos e plano de fundo, fonte, e outros elementos. É importante manter a consistência para os diversos gráficos que vão constituir o mesmo documento;&lt;/li>
&lt;li>&lt;strong>&lt;a href="#dimens%c3%b5es">Dimensões&lt;/a>:&lt;/strong> A definição da largura e altura da figura, bem como o tamanho da fonte, devem ser condizentes com o tipo de conteúdo onde o gráfico será inserido, seja em slides, pôster, relatório, artigo, postagem nas redes sociais e muitos outros;&lt;/li>
&lt;li>&lt;strong>&lt;a href="#formato">Formato&lt;/a>:&lt;/strong> O formato no qual as figuras serão salvas. Opções vetoriais são preferíveis, porque mantém uma boa apresentação visual mesmo em telas ou impressões de alta resolução, ou quando as figuras são ampliadas.&lt;/li>
&lt;/ol>
&lt;!--adsense-->
&lt;h2 id="metodologia">Metodologia&lt;/h2>
&lt;p>Os pontos acima serão abordados em Python, ou mais especificamente, no pacote &lt;a href="https://matplotlib.org/" target="_blank" rel="noopener">Matplotlib&lt;/a>, que é uma biblioteca de plotagem 2D, que produz figuras de qualidade de publicação em uma variedade de formatos impressos e ambientes interativos para múltiplas plataformas. Matplotlib pode ser usada em scripts Python, nos shells do Python e do &lt;a href="https://ipython.org/" target="_blank" rel="noopener">IPython&lt;/a>, no &lt;a href="https://jupyter.org/" target="_blank" rel="noopener">Jupyter Notebook&lt;/a>, nos servidores de aplicativos da web e em quatro kits de ferramentas de interface gráfica do usuário. &lt;strong>Matplotlib tenta tornar as coisas fáceis simples e as coisas difíceis possíveis&lt;/strong>. Você pode gerar gráficos, histogramas, espectros de potência, gráficos de barras, gráficos de erros, diagramas de dispersão, etc., com apenas algumas linhas de código.&lt;/p>
&lt;p>Além disso, funções de plotagem Matplotlib são integradas às principais soluções para gerenciamento de dados em Python, como &lt;a href="https://numpy.org/" target="_blank" rel="noopener">NumPy&lt;/a>, &lt;a href="https://pandas.pydata.org/" target="_blank" rel="noopener">Pandas&lt;/a>, &lt;a href="http://xarray.pydata.org/en/stable/" target="_blank" rel="noopener">Xarray&lt;/a>, &lt;a href="https://dask.org/" target="_blank" rel="noopener">Dask&lt;/a> e muitos outros.&lt;/p>
&lt;p>Confira na &lt;a href="https://matplotlib.org/stable/install/index.html" target="_blank" rel="noopener">documentação do Matplotlib&lt;/a> a melhor maneira de instalação no seu sistema. Podemos importar para nosso código com:&lt;/p>
&lt;pre>&lt;code class="language-python">import matplotlib.pyplot as plt
&lt;/code>&lt;/pre>
&lt;p>Agora vamos abordar especificamente cada tópico listado para a produção de figuras com qualidade de publicação.&lt;/p>
&lt;h3 id="localização">Localização&lt;/h3>
&lt;p>Se seu interesse é produzir conteúdo em língua inglesa, indico que pule para o &lt;a href="#estilo">próximo tópico&lt;/a>. Caso contrário, podemos usar o pacote &lt;a href="https://docs.python.org/3.8/library/locale.html" target="_blank" rel="noopener">locale&lt;/a> para garantir a consistência de nossas figuras com os padrões da língua portuguesa, por exemplo, ou realmente qualquer outra. Para tanto, podemos importar o pacote e definir a linguagem padrão como português:&lt;/p>
&lt;pre>&lt;code class="language-python">import locale
locale.setlocale(locale.LC_ALL, &amp;quot;pt_BR.utf8&amp;quot;)
&lt;/code>&lt;/pre>
&lt;p>Todos os parâmetros personalizáveis são armazenados no &lt;a href="https://docs.python.org/pt-br/3.8/tutorial/datastructures.html#dictionaries" target="_blank" rel="noopener">dicionário&lt;/a> &lt;code>plt.rcParams&lt;/code>, uma visão completa está disponível na página de sua &lt;a href="https://matplotlib.org/3.1.1/tutorials/introductory/customizing.html" target="_blank" rel="noopener">Documentação&lt;/a>, mas não se preocupe, os principais pontos serão demonstrados aqui.&lt;/p>
&lt;p>O passo a seguir é informar que queremos utilizar outro idioma para a notação nos eixos dos gráficos, por exemplo, usar &lt;code>,&lt;/code> como separador decimal, fazemos isso com o seguinte código:&lt;/p>
&lt;pre>&lt;code class="language-python">plt.rcParams.update(
{
'axes.formatter.use_locale' : True,
}
)
&lt;/code>&lt;/pre>
&lt;p>Não faz sentido confundir o público com diferentes separadores de decimal se podemos resolver isso facilmente com três linhas de código, não é mesmo?&lt;/p>
&lt;p>Perceba que essa definição só é válida para os eixos das figuras, não modificando o comportamento do próprio núcleo Python, por exemplo:&lt;/p>
&lt;pre>&lt;code class="language-python">value = 0.67
print(value)
&lt;/code>&lt;/pre>
&lt;pre>&lt;code class="language-text"> 0.67
&lt;/code>&lt;/pre>
&lt;p>Note que a impressão ainda usa o ponto como separador decimal. Para impressões, anotações ou legendas nas figuras, podemos usar o método &lt;code>locale.str()&lt;/code> para formatar automaticamente os números em ponto flutuante:&lt;/p>
&lt;pre>&lt;code class="language-python">print(locale.str(value))
&lt;/code>&lt;/pre>
&lt;pre>&lt;code class="language-text"> 0,67
&lt;/code>&lt;/pre>
&lt;p>O que pode ser uma boa prática, uma vez que basta retornar uma linha de código para o inglês (&lt;code>locale.setlocale(locale.LC_ALL, &amp;quot;en_US.utf8&amp;quot;)&lt;/code>), que todo o restante do código irá se comportar adequadamente.&lt;/p>
&lt;p>Também é possível formatar facilmente dados monetários:&lt;/p>
&lt;pre>&lt;code class="language-python">print(locale.currency(value))
&lt;/code>&lt;/pre>
&lt;pre>&lt;code class="language-text"> 'R$ 0,67'
&lt;/code>&lt;/pre>
&lt;p>E o formato das datas, com o pacote &lt;a href="https://docs.python.org/3.8/library/time.html" target="_blank" rel="noopener">time&lt;/a>, veja:&lt;/p>
&lt;pre>&lt;code class="language-python">from time import gmtime, strftime
strftime(&amp;quot;%a, %d %b %Y %H:%M:%S +0000&amp;quot;, gmtime())
&lt;/code>&lt;/pre>
&lt;pre>&lt;code class="language-text"> 'qua, 14 out 2020 22:31:50 +0000'
&lt;/code>&lt;/pre>
&lt;h3 id="estilo">Estilo&lt;/h3>
&lt;p>Agora vamos falar sobre o estilo das figuras, incluindo sequencia de cores, estilo dos eixos, cor do fundo, presença ou não da grade, bem como seu próprio estilo, formatação das anotações e muitos outros detalhes.&lt;/p>
&lt;p>Uma série de estilos já estão preparados e inclusos na biblioteca, e todos eles estão disponíveis em &lt;a href="https://matplotlib.org/3.1.0/gallery/style_sheets/style_sheets_reference.html" target="_blank" rel="noopener">Documentação - Matplotlib&lt;/a>.
De lá, retirei alguns para exemplificar o leque de possibilidades que temos a nossa disposição:&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://matplotlib.org/3.1.0/_images/sphx_glr_style_sheets_reference_001.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://matplotlib.org/3.1.0/_images/sphx_glr_style_sheets_reference_002.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://matplotlib.org/3.1.0/_images/sphx_glr_style_sheets_reference_005.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://matplotlib.org/3.1.0/_images/sphx_glr_style_sheets_reference_006.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://matplotlib.org/3.1.0/_images/sphx_glr_style_sheets_reference_008.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://matplotlib.org/3.1.0/_images/sphx_glr_style_sheets_reference_009.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://matplotlib.org/3.1.0/_images/sphx_glr_style_sheets_reference_011.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>&lt;/p>
&lt;p>Indicamos o uso de um estilo pelo seu nome, e o seguinte comando:&lt;/p>
&lt;pre>&lt;code class="language-python">plt.style.use('ggplot')
&lt;/code>&lt;/pre>
&lt;p>É possível ainda combinar diversos estilos em uma lista, para a produção de resultados únicos:&lt;/p>
&lt;pre>&lt;code class="language-python">plt.style.use(['ggplot', 'dark_background'])
&lt;/code>&lt;/pre>
&lt;p>Note que os estilos mais à direita irão sobrescrever parâmetros definidos previamente pelos estilos à esquerda, então a ordem com que são fornecidos pode mudar o resultado do final.&lt;/p>
&lt;p>Pode-se ainda personalizar cada um dos aspectos dos gráficos individualmente, para mais detalhes, sugiro consultar a &lt;a href="https://matplotlib.org/3.1.1/tutorials/introductory/customizing.html" target="_blank" rel="noopener">Documentação - Matplotlib&lt;/a>.
Caso queira retomar os parâmetros originais, use:&lt;/p>
&lt;pre>&lt;code class="language-python">plt.rcdefaults()
&lt;/code>&lt;/pre>
&lt;h3 id="dimensões">Dimensões&lt;/h3>
&lt;p>Outro ponto essencial, a relação entre o tamanho da figura e o tamanho da fonte. Quando falamos em qualidade de publicação, os textos e números dos gráficos devem ser exatamente do mesmo tamanho que o restante do documento onde eles são inseridos.&lt;/p>
&lt;p>O ideal aqui é a precisa definição da largura e da altura que se deseja a figura, para que ela possa ser inserida no documento final em uma escala 1:1, sem nenhuma distorção.&lt;/p>
&lt;p>Há um pacote Python de minha autoria que facilita essa tarefa, o &lt;a href="https://pypi.org/project/figure-scale" target="_blank" rel="noopener">figure-scale&lt;/a>. Maiores detalhes podem ser encontrados em sua &lt;a href="https://docs.fschuch.com/figure-scale/" target="_blank" rel="noopener">Documentação&lt;/a>, mas aqui vamos ver um exemplo de uso.&lt;/p>
&lt;p>Primeiro, precisamos instalar o pacote:&lt;/p>
&lt;pre>&lt;code class="language-shell">pip install figure-scale
&lt;/code>&lt;/pre>
&lt;p>A classe &lt;code>FigureScale&lt;/code> é o principal componente do pacote.
Ela permite definir as dimensões da figura da maneira que for mais conveniente para seu caso:&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Largura e Altura&lt;/strong>: Especificar ambas as dimensões explicitamente;&lt;/li>
&lt;li>&lt;strong>Largura e Proporção&lt;/strong>: Especificar a largura e deixar a altura ser calculada a partir da proporção;&lt;/li>
&lt;li>&lt;strong>Altura e Proporção&lt;/strong>: Especificar a altura e deixar a largura ser calculada a partir da proporção.&lt;/li>
&lt;/ol>
&lt;p>Todas as dimensões podem ser especificadas em várias unidades. Vamos explorar cada abordagem:&lt;/p>
&lt;pre>&lt;code class="language-python">import figure_scale as fs
size_a = fs.FigureScale(units=&amp;quot;mm&amp;quot;, width=100, height=100)
size_b = fs.FigureScale(units=&amp;quot;mm&amp;quot;, width=100, aspect=1.0)
size_c = fs.FigureScale(units=&amp;quot;mm&amp;quot;, height=100, aspect=1.0)
&lt;/code>&lt;/pre>
&lt;p>Vamos detalhar cada um dos parâmetros:&lt;/p>
&lt;ul>
&lt;li>&lt;code>width&lt;/code> é a largura útil da página, isso é, a largura da página menos ambas margens. Ou a largura da coluna, para os casos em que isso se aplicar. Em documentos &lt;a href="https://www.latex-project.org/" target="_blank" rel="noopener">$\LaTeX$&lt;/a>, esse valor pode ser obtido com o comando &lt;code>\the\columnwidth&lt;/code>;&lt;/li>
&lt;li>&lt;code>height&lt;/code> pode ser usado para o ajuste da altura em termos absolutos, caso o ajuste fino seja desejado. Em documentos &lt;a href="https://www.latex-project.org/" target="_blank" rel="noopener">$\LaTeX$&lt;/a>, esse valor pode ser obtido com o comando &lt;code>\the\textheight&lt;/code>;&lt;/li>
&lt;li>&lt;code>aspect&lt;/code> define a altura da figura em valor relativo em relação à largura. Por exemplo, &lt;code>aspect=1.0&lt;/code> criará uma figura quadrada, enquanto &lt;code>aspect=9.0/16.0&lt;/code> criará a proporção certa para telas wide-screen;&lt;/li>
&lt;li>&lt;code>unit&lt;/code> representa a unidade de comprimento para &lt;code>width&lt;/code> e &lt;code>height&lt;/code>, algumas das opções suportadas são &amp;ldquo;in&amp;rdquo; (polegada), &amp;ldquo;mm&amp;rdquo;, &amp;ldquo;cm&amp;rdquo; e &amp;ldquo;pt&amp;rdquo; (pontos tipográfico, é a utilizada em $\LaTeX$). Assim, o objeto realiza a devida conversão de unidades, uma vez que Matplotlib espera essa definição em polegadas.&lt;/li>
&lt;/ul>
&lt;p>Note que apenas dois dos três parâmetros &lt;code>width&lt;/code>, &lt;code>height&lt;/code> e &lt;code>aspect&lt;/code> são necessários, o terceiro será calculado automaticamente a partir dos outros dois.
A classe &lt;code>FigureScale&lt;/code> implementa o protocole de &lt;a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" target="_blank" rel="noopener">Sequence&lt;/a>, fazendo com que possa ser aceito como argumento para o parâmetro &lt;code>figsize&lt;/code> em qualquer função Matplotlib que o aceite, como &lt;code>plt.subplots()&lt;/code>, &lt;code>plt.figure()&lt;/code> e outros.&lt;/p>
&lt;p>Veja como agora podemos definir com precisão o padrão de desejamos para dimensões e tamanho da fonte:&lt;/p>
&lt;pre>&lt;code class="language-python">plt.rcParams.update(
{
#
'figure.figsize' : fs.FigureScale(units='mm', width=160, aspect=1),
#
&amp;quot;axes.labelsize&amp;quot;: 12,
&amp;quot;font.size&amp;quot;: 12,
&amp;quot;legend.fontsize&amp;quot;: 12,
&amp;quot;xtick.labelsize&amp;quot;: 12,
&amp;quot;ytick.labelsize&amp;quot;: 12,
}
)
&lt;/code>&lt;/pre>
&lt;p>É possível realizar posteriormente um ajuste personalizado para cada figura, por exemplo:&lt;/p>
&lt;pre>&lt;code class="language-python">fig, axes = plt.subplots(figsize=fs.FigureScale(units='mm', width=160, aspect=1))
&lt;/code>&lt;/pre>
&lt;p>Toda minha produção técnica/científica tem sido feita em &lt;a href="https://www.latex-project.org/" target="_blank" rel="noopener">$\LaTeX$&lt;/a>, o que eu certamente recomendo. De fato, esse pode ser um tópico para outro post no futuro próximo.
Se esse não é o seu caso, pode ser o momento de prosseguir para o &lt;a href="#formato">próximo tópico&lt;/a>.
De qualquer maneira, vou compartilhar alguns outros ajustes para referência:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Artigo com o &lt;a href="https://www.ctan.org/pkg/els-cas-templates/" target="_blank" rel="noopener">template de duas colunas da Elsevier&lt;/a>:&lt;/p>
&lt;pre>&lt;code class="language-python">ptl.rcParams.update(
{
'figure.figsize' : fs.FigureScale(unit='pt', width=238.25444, aspect=3/4),
#
&amp;quot;axes.labelsize&amp;quot;: 8,
&amp;quot;font.size&amp;quot;: 8,
&amp;quot;legend.fontsize&amp;quot;: 8,
&amp;quot;xtick.labelsize&amp;quot;: 8,
&amp;quot;ytick.labelsize&amp;quot;: 8
}
)
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>Relatório técnico, Dissertação ou Tese com &lt;a href="https://www.abntex.net.br/" target="_blank" rel="noopener">abnTeX2&lt;/a>:&lt;/p>
&lt;pre>&lt;code class="language-python">ptl.rcParams.update(
{
'figure.figsize' : fs.FigureScale(unit='pt', width=455.0, aspect=3/4),
#
&amp;quot;axes.labelsize&amp;quot;: 12,
&amp;quot;font.size&amp;quot;: 12,
&amp;quot;legend.fontsize&amp;quot;: 12,
&amp;quot;xtick.labelsize&amp;quot;: 12,
&amp;quot;ytick.labelsize&amp;quot;: 12,
}
)
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>Pôster em tamanho A0 com &lt;a href="https://ctan.org/pkg/beamer" target="_blank" rel="noopener">beamer&lt;/a> (e &lt;a href="https://www.overleaf.com/latex/templates/landscape-beamer-poster-template/vjpmsxxdvtqk" target="_blank" rel="noopener">esse template&lt;/a>):&lt;/p>
&lt;pre>&lt;code class="language-python">ptl.rcParams.update(
{
'figure.figsize' : fs.FigureScale(unit='pt', width=2376.3973*.75, aspect=9/16),
#
&amp;quot;axes.labelsize&amp;quot;: 24,
&amp;quot;font.size&amp;quot;: 24,
&amp;quot;legend.fontsize&amp;quot;: 24,
&amp;quot;xtick.labelsize&amp;quot;: 24,
&amp;quot;ytick.labelsize&amp;quot;: 24,
}
)
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>Apresentação de slides com &lt;a href="https://ctan.org/pkg/beamer" target="_blank" rel="noopener">beamer&lt;/a> (e o tema &lt;a href="https://github.com/elauksap/focus-beamertheme" target="_blank" rel="noopener">Focus v2.6&lt;/a>):&lt;/p>
&lt;pre>&lt;code class="language-python">ptl.rcParams.update(
{
'figure.figsize' : fs.FigureScale(unit='pt', width=412.56497), aspect=9/16,
}
)
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;p>Em $\LaTeX$, você tem a certeza de que deu tudo certo quando a figura é incluída com &lt;code>scale=1&lt;/code>, e as dimensões e tamanho de fonte tem a aparência adequada, por exemplo:&lt;/p>
&lt;pre>&lt;code class="language-latex">\includegraphics[scale=1]{&amp;lt;nome_da_figura&amp;gt;}
&lt;/code>&lt;/pre>
&lt;!--adsense-->
&lt;h3 id="formato">Formato&lt;/h3>
&lt;p>Por fim, temos o formato no qual serão salvos os gráficos.
Eles podem ser divididos basicamente em dois grandes grupos, e temos um bloco de código para exemplificar:&lt;/p>
&lt;pre>&lt;code class="language-python">import numpy as np
x = np.linspace(0.0, 2.0 * np.pi)
y = np.sin(x)
for f in ['jpg', 'svg']:
plt.plot(x,y, label = 'Label')
plt.legend()
plt.savefig('example_line.'+f, format=f)
&lt;/code>&lt;/pre>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Formato de matriz&lt;/strong>: A figura é constituída por um arranjo de pixels (ou matriz), que possuí um tamanho definido, por exemplo 240 x 120 pixels. Se quisermos amplia-la, veremos cada pequeno pixel, em um efeito meio quadriculado. Nesse grupo temos por exemplo os formatos JPG e PNG, veja o resultado:&lt;/p>
&lt;figure id="figure-figura-em-formato-de-matriz-768-x-576-pixels-jpg">
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >
&lt;img alt="Figura em formato de matriz 768 x 576 pixels (jpg)." srcset="
/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/example_line_hu4a02b2ee2cc82d426183992a53dbd112_51903_5dfb47db9dffca673319f3b8411ff61c.jpg 400w,
/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/example_line_hu4a02b2ee2cc82d426183992a53dbd112_51903_f3c1f8eda28b893d9b6b6e6bf774c689.jpg 760w,
/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/example_line_hu4a02b2ee2cc82d426183992a53dbd112_51903_1200x1200_fit_q90_lanczos.jpg 1200w"
src="https://www.fschuch.com/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/example_line_hu4a02b2ee2cc82d426183992a53dbd112_51903_5dfb47db9dffca673319f3b8411ff61c.jpg"
width="760"
height="570"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;figcaption>
Figura em formato de matriz 768 x 576 pixels (jpg).
&lt;/figcaption>&lt;/figure>
&lt;p>A qualidade da figura é controlada pelo número de pixels, ou o parâmetro &lt;strong>dpi&lt;/strong> (pontos por polegada, do inglês &lt;em>dots per inch&lt;/em>). Aumentar o dpi aumenta a qualidade da imagem, mas também aumenta seu espaço em disco;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Formato Vetorial&lt;/strong>: Aqui, a figura é composta por vetores, utilizando elementos matemáticos para compor a figura completa. Ao contrário do grupo anterior, ela não perde qualidade quando ampliada. Como exemplo temos os formatos SVG e PDF, veja a figura:&lt;/p>
&lt;figure id="figure-figura-em-formato-vetorial-svg">
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >
&lt;img alt="Figura em formato vetorial (svg)."
src="https://www.fschuch.com/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/example_line.svg"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;figcaption>
Figura em formato vetorial (svg).
&lt;/figcaption>&lt;/figure>
&lt;/li>
&lt;/ol>
&lt;p>Mas afinal, qual escolher? A resposta é: isso depende.&lt;/p>
&lt;p>Eu diria que opções vetoriais são preferíveis (svg para web, PDF para produção técnica), porque mantém uma boa apresentação visual mesmo em telas ou impressões de alta resolução, ou quando as figuras são ampliadas.
Existem entretanto aplicações que simplesmente não aceitam formatos vetoriais (como algumas redes sociais), então podemos mudar para formato matricial (jpg ou png).
Outro desafio para o formato vetorial é quando temos um elevado número de artefatos vetoriais. Independente do tipo de gráfico, à medida que a quantidade de dados vai aumentando de centenas, para milhares e milhões de pontos, pode ser que o espaço que a figura vetorial ocupa em disco seja, afinal, impraticável.&lt;/p>
&lt;p>Note entretanto que existe uma abordagem intermediária, métodos em Matplotlib que permitem converter elementos vetoriais para representação matricial, chamados &lt;code>rasterization&lt;/code>.
Para exemplificar isso, temos um bloco de código modificado da &lt;a href="https://matplotlib.org/3.1.3/gallery/misc/rasterization_demo.html" target="_blank" rel="noopener">Documentação - Matplotlib&lt;/a>, veja o código e a figura resultante:&lt;/p>
&lt;pre>&lt;code class="language-python">import numpy as np
import matplotlib.pyplot as plt
d = np.arange(100).reshape(10, 10)
x, y = np.meshgrid(np.arange(11), np.arange(11))
theta = 0.25*np.pi
xx = x*np.cos(theta) - y*np.sin(theta)
yy = x*np.sin(theta) + y*np.cos(theta)
fig, (ax1, ax2, ax3) = plt.subplots(1, 3)
ax1.set_aspect(1)
ax1.pcolormesh(xx, yy, d)
ax1.text(0.5, 0.5, &amp;quot;Text&amp;quot;, alpha=0.2,
va=&amp;quot;center&amp;quot;, ha=&amp;quot;center&amp;quot;, size=50, transform=ax1.transAxes)
ax1.set_title(&amp;quot;No Rasterization&amp;quot;)
ax2.set_aspect(1)
ax2.pcolormesh(xx, yy, d, zorder=-15)
ax2.text(0.5, 0.5, &amp;quot;Text&amp;quot;, alpha=0.2, zorder=5,
va=&amp;quot;center&amp;quot;, ha=&amp;quot;center&amp;quot;, size=50, transform=ax2.transAxes)
ax2.set_title(&amp;quot;Rasterization z$&amp;lt;-10$&amp;quot;)
ax2.set_rasterization_zorder(-10)
ax3.set_aspect(1)
ax3.pcolormesh(xx, yy, d)
ax3.text(0.5, 0.5, &amp;quot;Text&amp;quot;, alpha=0.2,
va=&amp;quot;center&amp;quot;, ha=&amp;quot;center&amp;quot;, size=50, transform=ax3.transAxes)
ax3.set_title(&amp;quot;Rasterization&amp;quot;)
ax3.set_rasterized(True)
plt.savefig(&amp;quot;test_rasterization.pdf&amp;quot;, dpi=150)
plt.savefig(&amp;quot;test_rasterization.eps&amp;quot;, dpi=150)
if not plt.rcParams[&amp;quot;text.usetex&amp;quot;]:
plt.savefig(&amp;quot;test_rasterization.svg&amp;quot;)
&lt;/code>&lt;/pre>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >
&lt;img alt=""
src="https://www.fschuch.com/blog/2020/10/14/graficos-com-qualidade-de-publicacao-em-python-com-matplotlib/test_rasterization.svg"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;p>Vemos acima uma figura vetorial com três sub-gráficos:&lt;/p>
&lt;ul>
&lt;li>No elemento à esquerda, temos a figura puramente vetorial (&lt;em>No Rasterization&lt;/em>), perceba a boa qualidade visual mesmo quando ampliada;&lt;/li>
&lt;li>A figura à direita foi convertida para o formato matricial (&lt;em>Rasterization&lt;/em>) com a linha &lt;code>ax3.set_rasterized(True)&lt;/code>, incluindo título, coordenadas, anotação e o &lt;code>pcolormesh&lt;/code>, mesmo que a figura tenha sido salva em svg. Perceba como ela foi totalmente representada pixel por pixel;&lt;/li>
&lt;li>No centro temos uma solução intermediária. Nesse caso, apenas elementos com &lt;code>zorder&lt;/code>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> menor que &lt;code>-10&lt;/code> foram transformados com a linha &lt;code>ax2.set_rasterization_zorder(-10)&lt;/code>, nesse caso temos o &lt;code>pcolormesh&lt;/code>. Título, coordenadas e a anotação permaneceram vetoriais, e assim, podemos obter o melhor de dois mundos.&lt;/li>
&lt;/ul>
&lt;p>A efetiva escolha sobre quais elementos converter é novamente um compromisso entre a qualidade da imagem e o seu tamanho em disco, e isso certamente depende de cada aplicação, ou mesmo da preferência pessoal. Note que dpi ainda é um parâmetro válido para os elementos convertidos para pixels.&lt;/p>
&lt;p>Finalmente, podemos definir esses parâmetros para serem aplicados como padrão em nosso código da seguinte maneira:&lt;/p>
&lt;pre>&lt;code class="language-python">plt.rcParams.update(
{
'figure.dpi' : 240,
'savefig.format' : 'pdf',
#
'text.usetex' : True,
'text.latex.preamble' : &amp;quot;\\usepackage{icomma}&amp;quot;,
}
)
&lt;/code>&lt;/pre>
&lt;p>A opção &lt;code>text.usetex&lt;/code> é particularmente útil para quem usa $\LaTeX$, permitindo incluir equações como anotações, título ou como rótulo para as coordenadas. A opção &lt;code>'text.latex.preamble' : &amp;quot;\\usepackage{icomma}&amp;quot;&lt;/code> é um bônus, isso elimina o espaço inserido em modo matemático após cada vírgula, que certamente não são bem-vindos quando falamos em qualidade de publicação.&lt;/p>
&lt;h2 id="conclusão">Conclusão&lt;/h2>
&lt;p>A apresentação de resultados em alta qualidade é um ponto fundamental para atrair engajamento e atenção do seu público.
Aqui demonstrou-se como a atenção nos detalhes e algumas poucas linhas de código podem ter um enorme impacto na apresentação dos resultados em formato gráfico.
Por fim, espero que esse meu relato sobre a produção de figuras em Python e Matplotlib lhe seja útil como um ponto de partida e motivação para seguir estudando o tema.&lt;/p>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;p>O parâmetro &lt;code>zorder&lt;/code> controla a ordem na qual cada elemento do gráfico será exibido, isso é, o texto com &lt;code>zorder=5&lt;/code> será exibido sobre a figura &lt;code>pcolormesh&lt;/code> com &lt;code>zorder=-15&lt;/code>. Para maiores informações, consulte a &lt;a href="https://matplotlib.org/3.1.1/gallery/misc/zorder_demo.html" target="_blank" rel="noopener">Documentação - Matplotlib&lt;/a>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/section></description></item></channel></rss>