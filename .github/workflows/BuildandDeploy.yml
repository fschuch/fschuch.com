name: Build and Deploy

on:
  push:
    branches:
      - master

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
#     - name: Setup Go environment
#       uses: actions/setup-go@v2.1.3
#       with:
#         # The Go version to download (if necessary) and use. Supports semver spec and ranges.
#         go-version: # optional
#         # Whether to download only stable versions
#         stable: # optional, default is true
#         # Used to pull node distributions from go-versions.  Since there's a default, this is typically not supplied by the user.
#         token: # optional, default is ${{ github.token }}

    - name: Checkout master
      uses: actions/checkout@v2

#     - name: Debug
#       run: echo "/home/runner/go/bin" >> $GITHUB_PATH

#     - name: Debug
#       run: echo $PATH

    - name: Setup Hugo
      uses: peaceiris/actions-hugo@v2
      with:
        hugo-version: '0.81.0'
        extended: true

    - name: Build
      run: hugo --minify

    - name: Deploy
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.TOKEN }}
        external_repository: fschuch/fschuch.github.io
        publish_dir: ./public
        publish_branch: master
        cname: www.fschuch.com

#     - name: Hugo Deploy GitHub Pages
#       uses: benmatselby/hugo-deploy-gh-pages@master
#       env:
#         HUGO_VERSION: 0.81.0
#         HUGO_EXTENDED: true
#         TARGET_REPO: fschuch/fschuch.github.io
#         TOKEN: ${{ secrets.TOKEN }}
#         CNAME: www.fschuch.com
#         GOPAH: /home/runner/go
#         GOBIN: /home/runner/go/bin
